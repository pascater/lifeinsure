<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Calcola il premio della tua assicurazione vita con LifeInsure.">
    <meta name="author" content="LifeInsure Team">
    <title>LifeInsure - Calcolo Premio Assicurazione Vita</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <!-- Bootstrap Icons-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic" rel="stylesheet" type="text/css">
    <!-- SimpleLightbox plugin CSS-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.css" rel="stylesheet">
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="css/styles.css" rel="stylesheet">
    <style>
        /* Stili aggiuntivi specifici per questa pagina, se necessario */
        body {
            padding-top: 56px; /* Aggiusta padding per il fixed-top navbar */
        }
        .form-section {
            padding: 60px 0;
        }
        .form-control:focus {
            border-color: #f4623a;
            box-shadow: 0 0 0 0.25rem rgba(244, 98, 58, 0.25);
        }
        .btn-primary {
            background-color: #f4623a;
            border-color: #f4623a;
        }
        .btn-primary:hover {
            background-color: #d9534f;
            border-color: #d9534f;
        }
        .premium-result {
            margin-top: 30px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 0.25rem;
            background-color: #f8f9fa;
        }
    </style>
</head>

<body id="page-top">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html"><img src="assets/images/lifeinsure-logo-bianco-trasp.png" alt="LifeInsure Logo" height="30"> LifeInsure</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="chi-siamo.html">Chi Siamo</a></li>
                    <li class="nav-item"><a class="nav-link" href="prodotti.html">Prodotti</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle active" href="#" id="navbarDropdownServizi" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Servizi Online <span class="visually-hidden">(current)</span>
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdownServizi">
                            <!-- Modificato: Aggiunta classe 'active' a Calcolo Premio -->
                            <li><a class="dropdown-item active" href="calcolo-premio.html">Calcolo Premio <span class="visually-hidden">(current)</span></a></li>
                            <!-- Modificato: Rimossa classe 'active' da Richiesta Offerta -->
                            <li><a class="dropdown-item" href="richiestaofferta.html">Richiesta Offerta</a></li>
                            <li><a class="dropdown-item" href="area-clienti.html">Area Clienti</a></li>
                        </ul>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="contatti.html">Contatti</a></li>
                    <li class="nav-item"><a class="nav-link" href="faq.html">FAQ</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Form Section -->
    <section class="form-section bg-light">
        <div class="container px-4 px-lg-5">
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-lg-8 col-xl-6 text-center">
                    <h2 class="mt-0">Calcola il Tuo Premio</h2>
                    <hr class="divider divider-dark" />
                    <p class="text-muted mb-5">Inserisci i tuoi dati per ottenere una stima del premio assicurativo.</p>
                </div>
            </div>
            <div class="row gx-4 gx-lg-5 justify-content-center mb-5">
                <div class="col-lg-6">
                    <form id="premiumCalculatorForm">
                        <!-- Data di Nascita -->
                        <div class="form-floating mb-3">
                            <input class="form-control" id="birthDate" type="date" placeholder="Data di Nascita" required>
                            <label for="birthDate">Data di Nascita</label>
                        </div>
                        <!-- Sesso -->
                        <div class="form-floating mb-3">
                           <select class="form-select" id="gender" aria-label="Sesso" required>
                                <option selected disabled value="">Seleziona Sesso...</option>
                                <option value="M">Maschio</option>
                                <option value="F">Femmina</option>
                            </select>
                            <label for="gender">Sesso</label>
                        </div>
                        <!-- Fumatore -->
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" value="" id="isSmoker">
                            <label class="form-check-label" for="isSmoker">
                                Sei un fumatore?
                            </label>
                        </div>
                         <!-- Capitale Assicurato -->
                        <div class="form-floating mb-3">
                            <input class="form-control" id="insuredCapital" type="number" placeholder="Capitale Assicurato (€)" data-sb-validations="required,number" min="10000" step="1000" required>
                            <label for="insuredCapital">Capitale Assicurato (€)</label>
                             <div class="small text-muted">Minimo 10.000 €</div>
                        </div>
                         <!-- Durata Copertura (anni) -->
                         <div class="form-floating mb-3">
                            <input class="form-control" id="coverageDuration" type="number" placeholder="Durata Copertura (anni)" data-sb-validations="required,number" min="5" max="30" required>
                            <label for="coverageDuration">Durata Copertura (anni)</label>
                            <div class="small text-muted">Minimo 5, Massimo 30 anni</div>
                        </div>

                        <!-- Submit Button-->
                        <div class="d-grid">
                            <button class="btn btn-primary btn-xl" id="submitButton" type="submit">Calcola Premio</button>
                        </div>
                    </form>
                </div>
            </div>
            <!-- Premium Result Display -->
            <div class="row gx-4 gx-lg-5 justify-content-center">
                <div class="col-lg-6">
                    <div id="premiumResult" class="premium-result" style="display: none;">
                        <h4>Stima del Premio Annuo:</h4>
                        <p id="resultText" class="lead"></p>
                        <p class="small text-muted">Nota: Questa è una stima preliminare. Il premio finale potrebbe variare in base a valutazioni più dettagliate.</p>
                         <div class="text-center mt-4">
                             <a class="btn btn-secondary" href="richiestaofferta.html">Richiedi un'Offerta Dettagliata</a>
                         </div>
                    </div>
                     <div id="calculationError" class="alert alert-danger mt-3" style="display: none;">
                        Errore nel calcolo. Assicurati di aver inserito dati validi. L'età massima alla scadenza della polizza è generalmente 75-80 anni.
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer-->
    <footer class="bg-light py-5">
        <div class="container px-4 px-lg-5">
            <div class="small text-center text-muted">Copyright © 2023 - LifeInsure</div>
            <!-- Aggiungi link privacy policy o altri dati legali se necessario -->
        </div>
    </footer>

    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- SimpleLightbox plugin JS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/SimpleLightbox/2.1.0/simpleLightbox.min.js"></script>
    <!-- Core theme JS-->
    <script src="js/scripts.js"></script> <!-- Se hai uno script generale -->

    <!-- Custom JS for premium calculation -->
   <script>
        document.getElementById('premiumCalculatorForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Previeni l'invio standard del form

            // Nascondi risultati/errori precedenti
            document.getElementById('premiumResult').style.display = 'none';
            document.getElementById('calculationError').style.display = 'none';


            // Raccogli i dati
            const birthDate = new Date(document.getElementById('birthDate').value);
            const gender = document.getElementById('gender').value;
            const isSmoker = document.getElementById('isSmoker').checked;
            const insuredCapital = parseFloat(document.getElementById('insuredCapital').value);
            const coverageDuration = parseInt(document.getElementById('coverageDuration').value);

            // Validazione semplice (assicurati che i campi required siano gestiti da HTML5)
            if (!birthDate || !gender || isNaN(insuredCapital) || isNaN(coverageDuration)) {
                 showError('Per favore, compila tutti i campi correttamente.');
                return;
            }

            // Calcola età attuale
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const m = today.getMonth() - birthDate.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }

            // Calcola età alla scadenza
            const ageAtExpiry = age + coverageDuration;

             // Controllo età massima alla scadenza (esempio: 80 anni)
             const MAX_AGE_AT_EXPIRY = 80;
             if (ageAtExpiry > MAX_AGE_AT_EXPIRY) {
                 showError(`L'età alla scadenza della copertura (${ageAtExpiry} anni) supera il limite massimo consentito (${MAX_AGE_AT_EXPIRY} anni).`);
                 return;
             }
             // Controllo età minima (esempio: 18 anni)
             const MIN_AGE = 18;
             if (age < MIN_AGE) {
                  showError(`Devi avere almeno ${MIN_AGE} anni per sottoscrivere una polizza.`);
                 return;
             }


            // --- Logica di Calcolo Stima Premio (MOLTO SEMPLIFICATA) ---
            // Questa è una formula puramente indicativa e NON reale.
            // I premi reali dipendono da tariffe complesse, stato di salute, professione, etc.
            let basePremium = (insuredCapital / 1000) * (age / 10) * (coverageDuration / 5);

            // Fattori moltiplicativi (esempi)
            if (gender === 'M') {
                basePremium *= 1.1; // Leggero aumento per gli uomini (statisticamente)
            }
             if (isSmoker) {
                 basePremium *= 1.8; // Aumento significativo per fumatori
             }
            // Aumento esponenziale con l'età (molto semplificato)
             basePremium *= (1 + (age / 100));
             // Aumento in base alla durata
             basePremium *= (1 + (coverageDuration / 50));


             // Arrotondamento a 2 decimali
             const estimatedPremium = Math.round(basePremium * 100) / 100;
            // --- Fine Logica Calcolo ---


            // Mostra il risultato
            document.getElementById('resultText').textContent = `€ ${estimatedPremium.toLocaleString('it-IT', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
            document.getElementById('premiumResult').style.display = 'block';

        });

        function showError(message) {
             const errorDiv = document.getElementById('calculationError');
             errorDiv.textContent = message;
             errorDiv.style.display = 'block';
             document.getElementById('premiumResult').style.display = 'none'; // Nascondi eventuali risultati precedenti
        }

   </script>

</body>

</html>
