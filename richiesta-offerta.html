<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:image:src"
      content="assets/images/richiesta-offerta-meta.png"
    />
    <meta
      property="og:image"
      content="assets/images/richiesta-offerta-meta.png"
    />
    <meta
      name="twitter:title"
      content="Richiesta di offerta polizza vita caso morte decesso Svizzera"
    />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, minimum-scale=1"
    />
    <link
      rel="shortcut icon"
      href="assets/images/lifeinsure-1-172x172.png"
      type="image/x-icon"
    />
    <meta
      name="description"
      content="Richiesta di offerta polizza vita decesso caso morte in Svizzera Ticino"
    />

    <title>Richiesta di offerta polizza vita caso morte decesso Svizzera</title>
    <link
      rel="stylesheet"
      href="assets/Material-Design-Icons/css/material.css"
    />
    <link rel="stylesheet" href="assets/icon54/style.css" />
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css" />
    <link
      rel="stylesheet"
      href="assets/bootstrap/css/bootstrap-reboot.min.css"
    />
    <link
      rel="stylesheet"
      href="assets/web/assets/gdpr-plugin/gdpr-styles.css"
    />
    <link rel="stylesheet" href="assets/popup-overlay-plugin/style.css" />
    <link rel="stylesheet" href="assets/dropdown/css/style.css" />
    <link rel="stylesheet" href="assets/socicon/css/styles.css" />
    <link rel="stylesheet" href="assets/theme/css/style.css" />
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css?family=Space+Grotesk:300,400,500,600,700&display=swap"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <noscript
      ><link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Space+Grotesk:300,400,500,600,700&display=swap"
    /></noscript>
    <link
      rel="preload"
      as="style"
      href="assets/mobirise/css/mbr-additional.css"
    />
    <link
      rel="stylesheet"
      href="assets/mobirise/css/mbr-additional.css"
      type="text/css"
    />
  </head>
  <body>
    <section
      data-bs-version="5.1"
      class="inspirem5 menu menu1 cid-uE0WswLKWX"
      once="menu"
      id="menu01-33"
    >
      <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container-fluid">
          <div class="navbar-brand">
            <span class="navbar-logo">
              <a href="index.html#top">
                <img
                  src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="
                  alt=""
                  style="height: 3.6rem"
                  loading="lazy"
                  class="lazyload"
                  data-src="assets/images/lifeinsure-1-172x172.png"
                />
              </a>
            </span>
          </div>
          <button
            class="navbar-toggler"
            type="button"
            data-toggle="collapse"
            data-bs-toggle="collapse"
            data-target="#navbarSupportedContent"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarNavAltMarkup"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <div class="hamburger">
              <span></span>
              <span></span>
              <span></span>
              <span></span>
            </div>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true">
              <li class="nav-item">
                <a
                  class="nav-link link text-primary display-7"
                  href="index.html#header01-2"
                  >Home</a
                >
              </li>
              <li class="nav-item dropdown">
                <a
                  class="nav-link link text-primary dropdown-toggle display-7"
                  href="index.html#features01-1"
                  data-toggle="dropdown-submenu"
                  data-bs-toggle="dropdown"
                  data-bs-auto-close="outside"
                  aria-expanded="false"
                  >Polizza decesso</a
                >
                <div class="dropdown-menu" aria-labelledby="dropdown-707">
                  <a
                    class="text-primary dropdown-item display-7"
                    href="index.html#progress-bars02-0"
                    >Vantaggi</a
                  ><a
                    class="text-primary show dropdown-item display-7"
                    href="index.html#progress-bars01-j"
                    >Valore</a
                  ><a
                    class="text-primary show dropdown-item display-7"
                    href="#"
                    data-toggle="modal"
                    data-bs-toggle="modal"
                    data-target="#mbr-popup-2k"
                    data-bs-target="#mbr-popup-2k"
                    ><span
                      class="mdi-content-markunread mbr-iconfont mbr-iconfont-btn"
                    ></span
                    >Una storia vera (leggi)</a
                  ><a
                    class="text-primary show dropdown-item display-7"
                    href="index.html#testimonials04-g"
                    >Testimonianze</a
                  >
                </div>
              </li>
              <li class="nav-item">
                <a
                  class="nav-link link text-primary display-7"
                  href="index.html#forms03-5"
                  >Chi siamo</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link link text-primary display-7"
                  href="index.html#forms03-5"
                  >Contatti</a
                >
              </li>
              <li class="nav-item dropdown">
                <a
                  class="nav-link link text-primary dropdown-toggle show display-7"
                  href="index.html#forms03-5"
                  data-toggle="dropdown-submenu"
                  data-bs-toggle="dropdown"
                  data-bs-auto-close="outside"
                  aria-expanded="false"
                  ><span
                    class="icon54-v1-translate2 mbr-iconfont mbr-iconfont-btn"
                  ></span
                ></a>
                <div
                  class="dropdown-menu show"
                  aria-labelledby="dropdown-852"
                  data-bs-popper="none"
                >
                  <a
                    class="text-primary dropdown-item display-7"
                    href="https://de.lifeinsure.ch"
                    target="_blank"
                    >Deutsch</a
                  ><a
                    class="text-primary dropdown-item display-7"
                    href="https://fr.lifeinsure.ch"
                    target="_blank"
                    >Français</a
                  >
                </div>
              </li>
            </ul>

            <div class="navbar-buttons mbr-section-btn">
              <a
                class="btn btn-lg btn-danger display-4"
                href="index.html#features04-2"
                ><span
                  class="icon54-v1-click-1 mbr-iconfont mbr-iconfont-btn"
                ></span
                >PREVENTIVO&nbsp;</a
              >
            </div>
          </div>
        </div>
      </nav>
    </section>

    <section
      data-bs-version="5.1"
      class="inspirem5 header3 cid-uF8evbKQfT"
      id="header03-3j"
    >
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-12 col-lg-11">
            <!-- <h2 class="mbr-section-subtitle mbr-fonts-style mb-3 display-2">
              Richiesta di offerta
            </h2> -->
          </div>
        </div>
      </div>
    </section>

    <div id="custom-html-3k">
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Richiesta Offerta Polizza Vita - Squarelife</title>
      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      />
      <style>
        .form-section {
          display: none;
        }
        .form-section.active {
          display: block;
        }
        .progress {
          height: 8px;
          margin-bottom: 30px;
        }
        .step-indicator {
          display: flex;
          justify-content: space-between;
          margin-bottom: 20px;
        }
        .step {
          text-align: center;
          flex: 1;
          position: relative;
        }
        .step-number {
          width: 30px;
          height: 30px;
          border-radius: 50%;
          background-color: #dee2e6;
          color: #6c757d;
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 0 auto 5px;
          font-weight: bold;
        }
        .step.active .step-number {
          background-color: #0d6efd;
          color: white;
        }
        .step.completed .step-number {
          background-color: #198754;
          color: white;
        }
        .step-title {
          font-size: 0.8rem;
          color: #6c757d;
        }
        .step.active .step-title {
          color: #0d6efd;
          font-weight: bold;
        }
        .step.completed .step-title {
          color: #198754;
        }
        .required-field::after {
          content: "*";
          color: red;
          margin-left: 4px;
        }
        .subtitle {
          background-color: #f8f9fa;
          padding: 10px 15px;
          margin: 20px 0 15px;
          border-left: 4px solid #0d6efd;
          font-size: 1.1rem;
        }
        .info-icon {
          color: #6c757d;
          cursor: pointer;
          margin-left: 5px;
        }
        .is-invalid {
          border-color: #dc3545;
        }
        .invalid-feedback {
          display: none;
          color: #dc3545;
          font-size: 0.875em;
          margin-top: 0.25rem;
        }
        .show-error .is-invalid + .invalid-feedback {
          display: block;
        }
        .show-error input:invalid,
        .show-error select:invalid,
        .show-error textarea:invalid {
          border-color: #dc3545;
        }
        @media (max-width: 767px) {
          .step-title {
            display: none;
          }
        }
        .conditional-field {
          margin-top: 1rem;
          padding: 1rem;
          border-left: 3px solid #0d6efd;
          background-color: #f8f9fa;
        }
        @media (max-width: 767px) {
          .step-title {
            display: none;
          }
        }
        .thank-you-message {
          display: none;
          text-align: center;
          padding: 30px 0;
        }
        .thank-you-message.active {
          display: block;
        }
      </style>

      <div class="container py-5">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <div class="card shadow">
              <div class="card-header bg-primary text-white">
                <h4 class="mb-0">Richiesta Offerta Polizza Vita</h4>
              </div>
              <div class="card-body">
                <!-- Indicatore progressione -->
                <div class="step-indicator mb-4">
                  <div class="step active" id="step-1">
                    <div class="step-number">1</div>
                    <div class="step-title">Dati personali</div>
                  </div>
                  <div class="step" id="step-2">
                    <div class="step-number">2</div>
                    <div class="step-title">Questionario medico</div>
                  </div>
                  <div class="step" id="step-3">
                    <div class="step-number">3</div>
                    <div class="step-title">Beneficiari e conferma</div>
                  </div>
                </div>

                <div class="progress">
                  <div
                    class="progress-bar"
                    role="progressbar"
                    style="width: 33%"
                    aria-valuenow="33"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>

                <form id="offer-request-form" novalidate="">
                  <!-- STEP 1: Dati personali -->
                  <div class="form-section active" id="section-1">
                    <div class="subtitle">Dati personali</div>

                    <div class="row mb-3">
                      <div class="col-md-6">
                        <label for="firstname" class="form-label required-field"
                          >Nome</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="firstname"
                          name="firstname"
                          required=""
                        />
                        <div class="invalid-feedback">
                          Inserisci il tuo nome
                        </div>
                      </div>
                      <div class="col-md-6">
                        <label for="lastname" class="form-label required-field"
                          >Cognome</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="lastname"
                          name="lastname"
                          required=""
                        />
                        <div class="invalid-feedback">
                          Inserisci il tuo cognome
                        </div>
                      </div>
                    </div>

                    <div class="row mb-3">
                      <div class="col-md-6">
                        <label for="gender" class="form-label required-field"
                          >Genere</label
                        >
                        <select
                          class="form-select"
                          id="gender"
                          name="gender"
                          required=""
                        >
                          <option value="" selected="" disabled="">
                            Seleziona...
                          </option>
                          <option value="M">Maschile</option>
                          <option value="F">Femminile</option>
                        </select>
                        <div class="invalid-feedback">
                          Seleziona il tuo genere
                        </div>
                      </div>
                      <div class="col-md-6">
                        <label for="birthdate" class="form-label required-field"
                          >Data di nascita</label
                        >
                        <input
                          type="date"
                          class="form-control"
                          id="birthdate"
                          name="birthdate"
                          required=""
                          min="1960-01-01"
                          max="2007-09-30"
                        />
                        <div class="invalid-feedback">
                          Inserisci la tua data di nascita
                        </div>
                      </div>
                    </div>

                    <div class="mb-3">
                      <label for="street" class="form-label required-field"
                        >Indirizzo</label
                      >
                      <input
                        type="text"
                        class="form-control"
                        id="street"
                        name="street"
                        required=""
                      />
                      <div class="invalid-feedback">
                        Inserisci il tuo indirizzo
                      </div>
                    </div>

                    <div class="row mb-3">
                      <div class="col-md-4">
                        <label for="zip" class="form-label required-field"
                          >CAP</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="zip"
                          name="zip"
                          required=""
                        />
                        <div class="invalid-feedback">Inserisci il tuo CAP</div>
                      </div>
                      <div class="col-md-4">
                        <label for="city" class="form-label required-field"
                          >Città</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="city"
                          name="city"
                          required=""
                        />
                        <div class="invalid-feedback">
                          Inserisci la tua città
                        </div>
                      </div>
                      <div class="col-md-4">
                        <label for="country" class="form-label required-field"
                          >Paese</label
                        >
                        <select
                          class="form-select"
                          id="country"
                          name="country"
                          required=""
                        >
                          <option value="CH" selected="">Svizzera</option>
                          <option value="IT">Italia</option>
                          <option value="DE">Germania</option>
                          <option value="FR">Francia</option>
                          <option value="AT">Austria</option>
                        </select>
                        <div class="invalid-feedback">
                          Seleziona il tuo paese
                        </div>
                      </div>
                    </div>

                    <div class="row mb-3">
                      <div class="col-md-6">
                        <label for="email" class="form-label required-field"
                          >Email</label
                        >
                        <input
                          type="email"
                          class="form-control"
                          id="email"
                          name="email"
                          required=""
                        />
                        <div class="invalid-feedback">
                          Inserisci un indirizzo email valido
                        </div>
                      </div>
                      <div class="col-md-6">
                        <label for="phone" class="form-label required-field"
                          >Telefono</label
                        >
                        <input
                          type="tel"
                          class="form-control"
                          id="phone"
                          name="phone"
                          required=""
                        />
                      </div>
                    </div>

                    <div class="row mb-3">
                      <div class="col-md-6">
                        <label
                          for="nationality"
                          class="form-label required-field"
                          >Nazionalità</label
                        >
                        <select
                          class="form-select"
                          id="nationality"
                          name="nationality"
                          required=""
                        >
                          <option value="it-CH" selected>Svizzera</option>
                          <option value="it-IT">Italiana</option>
                          <option value="de-DE">Tedesca</option>
                          <option value="fr-FR">Francese</option>
                          <option value="de-AT">Austriaca</option>
                        </select>
                      </div>
                      <div class="col-md-6">
                        <label
                          for="profession"
                          class="form-label required-field"
                          >Professione</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="profession"
                          name="profession"
                          required=""
                        />
                        <div class="invalid-feedback">
                          Inserisci la tua professione
                        </div>
                      </div>
                    </div>

                    <div class="subtitle">Dettagli polizza</div>

                    <div class="row mb-3">
                      <div class="col-md-6">
                        <label for="duration" class="form-label required-field"
                          >Durata (anni)</label
                        >
                        <select
                          class="form-select"
                          id="durata-select"
                          onchange="toggleDurataPersonalizzata()"
                          name="durata-select"
                          required=""
                        >
                          <option value="" disabled="" selected="">
                            Seleziona la durata
                          </option>
                          <option value="5">5 anni</option>
                          <option value="10">10 anni</option>
                          <option value="15">15 anni</option>
                          <option value="20">20 anni</option>
                          <option value="25">25 anni</option>
                          <option value="30">30 anni</option>
                          <option value="custom">Scegli tu la durata</option>
                        </select>
                        <div id="durata-custom-container" class="mt-2 d-none">
                          <div class="input-group">
                            <input
                              type="number"
                              class="form-control"
                              id="durata-custom"
                              min="5"
                              max="30"
                              placeholder="Inserisci durata (5-30 anni)"
                            />
                            <span class="input-group-text">anni</span>
                          </div>
                        </div>
                        <div class="invalid-feedback">
                          Seleziona la durata della polizza
                        </div>
                      </div>

                      <div class="col-md-6">
                        <label for="coverage" class="form-label required-field"
                          >Copertura (CHF)</label
                        >
                        <input
                          type="number"
                          class="form-control"
                          id="coverage"
                          name="coverage"
                          min="20000"
                          max="600000"
                          step="10000"
                          value="100000"
                          required=""
                        />
                        <div class="invalid-feedback">
                          Inserisci un importo di copertura valido
                        </div>
                      </div>
                    </div>

                    <div class="row mb-3">
                      <div class="col-md-6">
                        <label for="mode" class="form-label required-field"
                          >Modalità di pagamento</label
                        >
                        <select
                          class="form-select"
                          id="mode"
                          name="mode"
                          required=""
                        >
                          <option value="annual" selected="">Annuale</option>
                          <option value="monthly">Mensile</option>
                        </select>
                        <div class="invalid-feedback">
                          Seleziona la modalità di pagamento
                        </div>
                      </div>
                      <div class="col-md-6">
                        <label
                          for="payment_type"
                          class="form-label required-field"
                          >Tipo di pagamento</label
                        >
                        <select
                          class="form-select"
                          id="payment_type"
                          name="payment_type"
                          required=""
                        >
                          <option value="invoice_esr" selected="">
                            E-Bill
                          </option>
                          <option value="manual">Fattura con QR code</option>
                        </select>
                        <div class="invalid-feedback">
                          Seleziona il tipo di pagamento
                        </div>
                      </div>
                    </div>

                    <div class="d-flex justify-content-end mt-4">
                      <button type="button" id="next-1" class="btn btn-primary">
                        Avanti
                      </button>
                    </div>
                  </div>

                  <!-- STEP 2: Questionario medico -->
                  <div class="form-section" id="section-2">
                    <div class="subtitle">Informazioni di salute</div>

                    <div class="mb-3">
                      <label for="height" class="form-label required-field"
                        >Altezza (cm)</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="height"
                        name="height"
                        min="100"
                        max="250"
                        required=""
                      />
                      <div class="invalid-feedback">
                        Inserisci un'altezza valida (tra 100 e 250 cm)
                      </div>
                    </div>

                    <div class="mb-3">
                      <label for="weight" class="form-label required-field"
                        >Peso (kg)</label
                      >
                      <input
                        type="number"
                        class="form-control"
                        id="weight"
                        name="weight"
                        min="30"
                        max="200"
                        required=""
                      />
                      <div class="invalid-feedback">
                        Inserisci un peso valido (tra 30 e 200 kg)
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="smoker_yes_lable"
                        >Negli ultimi 2 anni hai fumato regolarmente o
                        occasionalmente sigarette, sigari, pipa o sigarette
                        elettroniche?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="smoker_yes"
                          name="smoker"
                          value="yes"
                        />
                        <label class="form-check-label" for="smoker_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="smoker_no"
                          name="smoker"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="smoker_no"
                          >No</label
                        >
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="existing_insurance_label"
                        >Hai già altre assicurazioni sulla vita?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="existing_insurance_yes"
                          name="existing_insurance"
                          value="yes"
                        />
                        <label
                          class="form-check-label"
                          for="existing_insurance_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="existing_insurance_no"
                          name="existing_insurance"
                          value="no"
                          checked=""
                        />
                        <label
                          class="form-check-label"
                          for="existing_insurance_no"
                          >No</label
                        >
                      </div>

                      <div
                        id="existing_insurance_details"
                        class="conditional-field d-none"
                      >
                        <label for="existing_coverage" class="form-label"
                          >Copertura totale esistente (CHF)</label
                        >
                        <input
                          type="number"
                          class="form-control"
                          id="existing_coverage"
                          name="existing_coverage"
                        />
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="medication_yes_label"
                        >Hai assunto o ti sono stati prescritti farmaci per più
                        di 4 settimane consecutive negli ultimi 5 anni?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="medication_yes"
                          name="medication"
                          value="yes"
                        />
                        <label class="form-check-label" for="medication_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="medication_no"
                          name="medication"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="medication_no"
                          >No</label
                        >
                      </div>

                      <div
                        id="medication_details"
                        class="conditional-field d-none"
                      >
                        <label class="form-label" id="medication_resolved_label"
                          >La malattia sottostante è guarita senza conseguenze
                          da almeno 2 anni?</label
                        >
                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="radio"
                            id="medication_resolved_yes"
                            name="medication_resolved"
                            value="yes"
                          />
                          <label
                            class="form-check-label"
                            for="medication_resolved_yes"
                            >Sì</label
                          >
                        </div>
                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="radio"
                            id="medication_resolved_no"
                            name="medication_resolved"
                            value="no"
                          />
                          <label
                            class="form-check-label"
                            for="medication_resolved_no"
                            >No</label
                          >
                        </div>
                        <div class="mt-2">
                          <label for="medication_description" class="form-label"
                            >Descrizione:</label
                          >
                          <textarea
                            class="form-control"
                            id="medication_description"
                            name="medication_description"
                            rows="2"
                          ></textarea>
                        </div>
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="hypertension_yes_label"
                        >Negli ultimi 5 anni hai avuto l'ipertensione?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="hypertension_yes"
                          name="hypertension"
                          value="yes"
                        />
                        <label class="form-check-label" for="hypertension_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="hypertension_no"
                          name="hypertension"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="hypertension_no"
                          >No</label
                        >
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="hospitalization_yes_label"
                        >Sei stato ricoverato in ospedale negli ultimi 10
                        anni?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="hospitalization_yes"
                          name="hospitalization"
                          value="yes"
                        />
                        <label
                          class="form-check-label"
                          for="hospitalization_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="hospitalization_no"
                          name="hospitalization"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="hospitalization_no"
                          >No</label
                        >
                      </div>

                      <div
                        id="hospitalization_details"
                        class="conditional-field d-none"
                      >
                        <label
                          class="form-label"
                          id="hospitalization_resolved_yes_label"
                          >La malattia sottostante è guarita senza conseguenze
                          da almeno 2 anni?</label
                        >
                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="radio"
                            id="hospitalization_resolved_yes"
                            name="hospitalization_resolved"
                            value="yes"
                          />
                          <label
                            class="form-check-label"
                            for="hospitalization_resolved_yes"
                            >Sì</label
                          >
                        </div>
                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="radio"
                            id="hospitalization_resolved_no"
                            name="hospitalization_resolved"
                            value="no"
                          />
                          <label
                            class="form-check-label"
                            for="hospitalization_resolved_no"
                            >No</label
                          >
                        </div>
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="planned_exam_yes_label"
                        >È attualmente pianificato un esame (ECG, esami di
                        laboratorio, ecografia, RMT, ecc.)?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="planned_exam_yes"
                          name="planned_exam"
                          value="yes"
                        />
                        <label class="form-check-label" for="planned_exam_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="planned_exam_no"
                          name="planned_exam"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="planned_exam_no"
                          >No</label
                        >
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="drugs_yes_label"
                        >Negli ultimi 5 anni hai assunto stupefacenti o droghe o
                        sei stato consigliato o trattato per questo?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="drugs_yes"
                          name="drugs"
                          value="yes"
                        />
                        <label class="form-check-label" for="drugs_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="drugs_no"
                          name="drugs"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="drugs_no"
                          >No</label
                        >
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="hiv_yes_label"
                        >Ti è mai stata diagnosticata un'infezione da HIV (test
                        AIDS positivo) o sei in attesa del risultato?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="hiv_yes"
                          name="hiv"
                          value="yes"
                        />
                        <label class="form-check-label" for="hiv_yes">Sì</label>
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="hiv_no"
                          name="hiv"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="hiv_no">No</label>
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="foreign_stay_yes_label"
                        >Prevedi un soggiorno all'estero di durata superiore a 6
                        settimane nei prossimi 12 mesi? (Al di fuori di UE,
                        Svizzera, Islanda, Norvegia, USA, Canada)</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="foreign_stay_yes"
                          name="foreign_stay"
                          value="yes"
                        />
                        <label class="form-check-label" for="foreign_stay_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="foreign_stay_no"
                          name="foreign_stay"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="foreign_stay_no"
                          >No</label
                        >
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="dangerous_hobby_yes_label"
                        >Sei esposto a pericoli particolari nel lavoro o nel
                        tempo libero? (es. manipolazione di esplosivi o armi,
                        protezione personale, soggiorno in zone di crisi, gare
                        automobilistiche, sport aerei, alpinismo, arrampicata,
                        arti marziali, sport estremi, immersioni)</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="dangerous_hobby_yes"
                          name="dangerous_hobby"
                          value="yes"
                        />
                        <label
                          class="form-check-label"
                          for="dangerous_hobby_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="dangerous_hobby_no"
                          name="dangerous_hobby"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="dangerous_hobby_no"
                          >No</label
                        >
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label" id="pension_yes_label"
                        >Ricevi una pensione o un'indennità giornaliera
                        dall'assicurazione invalidità o da un'assicurazione
                        infortuni?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="pension_yes"
                          name="pension"
                          value="yes"
                        />
                        <label class="form-check-label" for="pension_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="pension_no"
                          name="pension"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="pension_no"
                          >No</label
                        >
                      </div>
                    </div>

                    <div class="mb-3">
                      <label class="form-label"
                        >Negli ultimi 5 anni, hai avuto assenze dal lavoro di
                        oltre un mese per malattia?</label
                      >
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="work_absence_yes"
                          name="work_absence"
                          value="yes"
                        />
                        <label class="form-check-label" for="work_absence_yes"
                          >Sì</label
                        >
                      </div>
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="radio"
                          id="work_absence_no"
                          name="work_absence"
                          value="no"
                          checked=""
                        />
                        <label class="form-check-label" for="work_absence_no"
                          >No</label
                        >
                      </div>

                      <div
                        id="work_absence_details"
                        class="conditional-field d-none"
                      >
                        <label class="form-label"
                          >La condizione è risolta da almeno 2 anni senza
                          trattamenti?</label
                        >
                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="radio"
                            id="work_absence_resolved_yes"
                            name="work_absence_resolved"
                            value="yes"
                          />
                          <label
                            class="form-check-label"
                            for="work_absence_resolved_yes"
                            >Sì</label
                          >
                        </div>
                        <div class="form-check">
                          <input
                            class="form-check-input"
                            type="radio"
                            id="work_absence_resolved_no"
                            name="work_absence_resolved"
                            value="no"
                          />
                          <label
                            class="form-check-label"
                            for="work_absence_resolved_no"
                            >No</label
                          >
                        </div>
                      </div>
                    </div>

                    <div class="subtitle">Condizioni mediche</div>

                    <div class="mb-3">
                      <label class="form-label"
                        >Negli ultimi 5 anni, hai sofferto di una delle seguenti
                        condizioni?</label
                      >

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="heart_disease"
                          name="conditions[]"
                          value="heart_disease"
                        />
                        <label class="form-check-label" for="heart_disease">
                          Problemi cardiaci o infarto
                        </label>
                      </div>

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="stroke"
                          name="conditions[]"
                          value="stroke"
                        />
                        <label class="form-check-label" for="stroke">
                          Ictus
                        </label>
                      </div>

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="diabetes"
                          name="conditions[]"
                          value="diabetes"
                        />
                        <label class="form-check-label" for="diabetes">
                          Diabete
                        </label>
                      </div>

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="cancer"
                          name="conditions[]"
                          value="cancer"
                        />
                        <label class="form-check-label" for="cancer">
                          Tumore
                        </label>
                      </div>

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="respiratory"
                          name="conditions[]"
                          value="respiratory"
                        />
                        <label class="form-check-label" for="respiratory">
                          Problemi respiratori cronici (es. BPCO, enfisema)
                        </label>
                      </div>

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="liver"
                          name="conditions[]"
                          value="liver"
                        />
                        <label class="form-check-label" for="liver">
                          Malattie del fegato
                        </label>
                      </div>

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="kidney"
                          name="conditions[]"
                          value="kidney"
                        />
                        <label class="form-check-label" for="kidney">
                          Malattie renali
                        </label>
                      </div>

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="epilepsy"
                          name="conditions[]"
                          value="epilepsy"
                        />
                        <label class="form-check-label" for="epilepsy">
                          Epilessia
                        </label>
                      </div>

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="multiple_sclerosis"
                          name="conditions[]"
                          value="multiple_sclerosis"
                        />
                        <label
                          class="form-check-label"
                          for="multiple_sclerosis"
                        >
                          Sclerosi multipla
                        </label>
                      </div>

                      <div class="form-check mb-2">
                        <input
                          class="form-check-input condition-checkbox"
                          type="checkbox"
                          id="mental_health"
                          name="conditions[]"
                          value="mental_health"
                        />
                        <label class="form-check-label" for="mental_health">
                          Problemi di salute mentale
                        </label>
                      </div>

                      <div
                        id="condition_details"
                        class="conditional-field d-none"
                      >
                        <label for="condition_notes" class="form-label"
                          >Fornisci dettagli sulle condizioni
                          selezionate:</label
                        >
                        <textarea
                          class="form-control"
                          id="condition_notes"
                          name="condition_notes"
                          rows="3"
                        ></textarea>
                      </div>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                      <button
                        type="button"
                        id="prev-2"
                        class="btn btn-secondary"
                      >
                        Indietro
                      </button>
                      <button type="button" id="next-2" class="btn btn-primary">
                        Avanti
                      </button>
                    </div>
                  </div>

                  <!-- STEP 3: Beneficiari e conferma -->
                  <div class="form-section" id="section-3">
                    <div class="subtitle">Beneficiari</div>

                    <div class="row mb-3">
                      <div class="col-md-12">
                        <label
                          for="beneficiary_type"
                          class="form-label required-field"
                          >Tipo di beneficiario</label
                        >
                        <select
                          class="form-select"
                          id="beneficiary_type"
                          name="beneficiary_type"
                          required=""
                        >
                          <option value="" selected="" disabled="">
                            Seleziona...
                          </option>
                          <option value="legal">Coniuge</option>
                          <option value="child">Figli</option>
                          <option value="parents">Genitori</option>
                          <option value="custom">Altro</option>
                        </select>
                        <div class="invalid-feedback">
                          Seleziona il tipo di beneficiario
                        </div>
                      </div>
                    </div>

                    <div
                      id="other_beneficiary"
                      class="conditional-field d-none"
                    >
                      <div class="row mb-3">
                        <div class="col-md-6">
                          <label for="beneficiary_firstname" class="form-label"
                            >Nome</label
                          >
                          <input
                            type="text"
                            class="form-control"
                            id="beneficiary_firstname"
                            name="beneficiary_firstname"
                          />
                        </div>
                        <div class="col-md-6">
                          <label for="beneficiary_lastname" class="form-label"
                            >Cognome</label
                          >
                          <input
                            type="text"
                            class="form-control"
                            id="beneficiary_lastname"
                            name="beneficiary_lastname"
                          />
                        </div>
                      </div>
                      <div class="mb-3">
                        <label for="beneficiary_relation" class="form-label"
                          >Relazione con l'assicurato</label
                        >
                        <input
                          type="text"
                          class="form-control"
                          id="beneficiary_relation"
                          name="beneficiary_relation"
                        />
                      </div>
                    </div>

                    <div class="subtitle">Consensi e Dichiarazioni</div>

                    <div class="mb-3">
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="checkbox"
                          id="privacy_consent"
                          name="privacy_consent"
                          required=""
                        />
                        <label
                          class="form-check-label required-field"
                          for="privacy_consent"
                          id="privacy_consent_label"
                        >
                          Ho letto e acconsento all'informativa sulla privacy e
                          al trattamento dei miei dati personali per le finalità
                          indicate.
                        </label>
                        <div class="invalid-feedback">
                          Devi accettare l'informativa sulla privacy
                        </div>
                      </div>
                    </div>

                    <div class="mb-3">
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="checkbox"
                          id="terms_consent"
                          name="terms_consent"
                          required=""
                        />
                        <label
                          class="form-check-label required-field"
                          for="terms_consent"
                          id="terms_consent_label"
                        >
                          Dichiaro che le informazioni fornite sono veritiere e
                          complete e acconsento ai termini e condizioni del
                          servizio.
                        </label>
                        <div class="invalid-feedback">
                          Devi accettare i termini e condizioni
                        </div>
                      </div>
                    </div>

                    <div class="mb-3">
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="checkbox"
                          id="mandate_consent"
                          name="mandate_consent"
                          required=""
                        />
                        <label
                          class="form-check-label required-field"
                          for="mandate_consent"
                          id="mandate_consent_label"
                        >
                          Conferisco mandato fiduciario per mediazione di
                          servizi assicurativi a Lifensure SA.
                        </label>
                        <div class="invalid-feedback">
                          È necessario conferire il mandato per procedere
                        </div>
                      </div>
                    </div>

                    <div class="mb-3">
                      <div class="form-check">
                        <input
                          class="form-check-input"
                          type="checkbox"
                          id="marketing_consent"
                          name="marketing_consent"
                        />
                        <label
                          class="form-check-label"
                          for="marketing_consent"
                          id="marketing_consent_label"
                        >
                          Acconsento a ricevere comunicazioni commerciali e
                          promozionali anche da terze parti.
                        </label>
                      </div>
                    </div>

                    <div class="mb-4">
                      <label for="notes" class="form-label"
                        >Note aggiuntive (facoltativo)</label
                      >
                      <textarea
                        class="form-control"
                        id="notes"
                        name="notes"
                        rows="3"
                      ></textarea>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                      <button
                        type="button"
                        id="prev-3"
                        class="btn btn-secondary"
                      >
                        Indietro
                      </button>
                      <button
                        type="submit"
                        id="submit-form"
                        class="btn btn-success"
                      >
                        Invia richiesta
                      </button>
                    </div>
                  </div>
                </form>
                <!-- Messaggio di ringraziamento -->
                <div class="thank-you-message" id="thank-you">
                  <div class="alert alert-success mb-4">
                    <h4 class="alert-heading">Grazie per la tua richiesta!</h4>
                    <p>
                      La tua richiesta di offerta è stata inviata con successo.
                      Riceverai un'email di conferma all'indirizzo fornito.
                    </p>
                    <hr />
                    <p class="mb-0">
                      Un nostro consulente ti contatterà entro 48 ore
                      lavorative.
                    </p>
                  </div>
                  <p>
                    Numero di riferimento:
                    <strong id="reference-number"> ABCD1234</strong>
                  </p>
                  <button
                    type="button"
                    id="new-request"
                    class="btn btn-primary mt-3"
                  >
                    Continua
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <script>
        function toggleDurataPersonalizzata() {
          const durataSelect = document.getElementById("durata-select");
          const durataCustomContainer = document.getElementById(
            "durata-custom-container"
          );
          const durataCustomInput = document.getElementById("durata-custom");

          if (durataSelect.value === "custom") {
            durataCustomContainer.classList.remove("d-none");
            durataCustomInput.required = true;
            durataCustomInput.focus();
          } else {
            durataCustomContainer.classList.add("d-none");
            durataCustomInput.required = false;
          }
        }
        function setDataFromSessionStorage() {
          // Recupera i dati salvati dalla pagina di preventivazione
          const datiPreventivoString = sessionStorage.getItem("datiPreventivo");

          if (datiPreventivoString) {
            try {
              const datiPreventivo = JSON.parse(datiPreventivoString);
              console.log(datiPreventivo);
              // Compila i campi della sezione "Dettagli polizza" con i dati recuperati
              if (datiPreventivo.durata_select) {
                const durataSelect = document.getElementById("durata-select");
                const durataCustom = document.getElementById("durata-custom");

                if (durataSelect) {
                  durataSelect.value = datiPreventivo.durata_select;
                }
                if (durataCustom && datiPreventivo.durata_select === "custom") {
                  toggleDurataPersonalizzata();
                  durataCustom.value = datiPreventivo.durata_custom;
                }
              }

              if (datiPreventivo.copertura) {
                const coperturaInput = document.getElementById("coverage");
                if (coperturaInput) {
                  coperturaInput.value = datiPreventivo.copertura;
                }
              }

              // Compila anche i campi relativi ai dati fisici
              if (datiPreventivo.altezza) {
                const altezzaInput = document.getElementById("height");
                if (altezzaInput) {
                  altezzaInput.value = datiPreventivo.altezza;
                }
              }

              if (datiPreventivo.peso) {
                const pesoInput = document.getElementById("weight");
                if (pesoInput) {
                  pesoInput.value = datiPreventivo.peso;
                }
              }

              if (datiPreventivo.fumatore !== undefined) {
                const fumatoreCheckbox = document.getElementById("smoker_yes");
                if (fumatoreCheckbox) {
                  fumatoreCheckbox.checked = datiPreventivo.fumatore;
                }
              }

              // Compila il campo data di nascita
              if (datiPreventivo.dataNascita) {
                const dataNascitaInput = document.getElementById("birthdate");
                if (dataNascitaInput) {
                  dataNascitaInput.value = datiPreventivo.dataNascita;
                }
              }

              // Mostra un messaggio informativo sui dati recuperati
              const alertPlaceholder = document.querySelector(".card-body");
              if (alertPlaceholder) {
                const alertDiv = document.createElement("div");
                alertDiv.className =
                  "alert alert-info alert-dismissible fade show mb-4";
                alertDiv.innerHTML = `
                        <strong>Dati preventivo importati:</strong> Copertura: ${
                          datiPreventivo.copertura
                        } ${datiPreventivo.currency || "CHF"}, 
                        Durata: ${
                          datiPreventivo["durata_select"] === "custom"
                            ? datiPreventivo["durata_custom"]
                            : datiPreventivo["durata_select"]
                        } anni, Premio: ${datiPreventivo.premio} ${
                  datiPreventivo.currency || "CHF"
                }
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Chiudi"></button>
                    `;

                // Inserisci l'alert all'inizio della card-body, prima dell'indicatore di progressione
                const progressIndicator =
                  document.querySelector(".step-indicator");
                if (progressIndicator) {
                  alertPlaceholder.insertBefore(alertDiv, progressIndicator);
                } else {
                  alertPlaceholder.prepend(alertDiv);
                }
              }
            } catch (error) {
              console.error(
                "Errore durante il parsing dei dati preventivo:",
                error
              );
            }
          }
        }
      </script>
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          // Elementi del form
          setDataFromSessionStorage();
          const form = document.getElementById("offer-request-form");
          const sections = document.querySelectorAll(".form-section");
          const progressBar = document.querySelector(".progress-bar");
          const steps = document.querySelectorAll(".step");
          const newRequestBtn = document.getElementById("new-request");
          const thankYouMessage = document.getElementById("thank-you");
          const submitBtn = document.querySelector(".btn-success");
          // Pulsanti di navigazione
          const next1Button = document.getElementById("next-1");
          const next2Button = document.getElementById("next-2");
          const prev2Button = document.getElementById("prev-2");
          const prev3Button = document.getElementById("prev-3");

          // Campi condizionali
          const existingInsuranceRadios = document.querySelectorAll(
            'input[name="existing_insurance"]'
          );
          const existingInsuranceDetails = document.getElementById(
            "existing_insurance_details"
          );

          const workAbsenceRadios = document.querySelectorAll(
            'input[name="work_absence"]'
          );
          const workAbsenceDetails = document.getElementById(
            "work_absence_details"
          );

          const riskyActivitiesRadios = document.querySelectorAll(
            'input[name="risky_activities"]'
          );
          const riskyActivitiesDetails = document.getElementById(
            "risky_activities_details"
          );

          const beneficiaryTypeSelect =
            document.getElementById("beneficiary_type");
          const beneficiaryDetails =
            document.getElementById("other_beneficiary");

          // Funzione per validare una sezione
          function validateSection(sectionId) {
            const section = document.getElementById(sectionId);
            section.classList.add("show-error");

            const requiredFields = section.querySelectorAll(
              "input[required], select[required], textarea[required]"
            );
            let valid = true;

            requiredFields.forEach((field) => {
              if (!field.checkValidity()) {
                valid = false;
                field.classList.add("is-invalid");
              } else {
                field.classList.remove("is-invalid");
              }
            });

            return valid;
          }

          // Funzione per passare alla sezione successiva
          function goToSection(currentSection, nextSection) {
            document.getElementById(currentSection).classList.remove("active");
            document.getElementById(nextSection).classList.add("active");

            // Aggiorna indicatore di progresso
            if (nextSection === "section-2") {
              progressBar.style.width = "66%";
              progressBar.setAttribute("aria-valuenow", "66");
              steps[0].classList.add("completed");
              steps[0].classList.remove("active");
              steps[1].classList.add("active");
            } else if (nextSection === "section-3") {
              progressBar.style.width = "100%";
              progressBar.setAttribute("aria-valuenow", "100");
              steps[1].classList.add("completed");
              steps[1].classList.remove("active");
              steps[2].classList.add("active");
            } else if (nextSection === "section-1") {
              progressBar.style.width = "33%";
              progressBar.setAttribute("aria-valuenow", "33");
              steps[1].classList.remove("active");
              steps[0].classList.remove("completed");
              steps[0].classList.add("active");
            }
          }

          if (newRequestBtn) {
            newRequestBtn.addEventListener("click", function () {
              window.location.href = "page8.html";
            });
          }
          // Gestione dei campi condizionali
          existingInsuranceRadios.forEach((radio) => {
            radio.addEventListener("change", function () {
              if (this.value === "yes" && this.checked) {
                existingInsuranceDetails.classList.remove("d-none");
              } else {
                existingInsuranceDetails.classList.add("d-none");
              }
            });
          });
          const medicationRadios = document.querySelectorAll(
            'input[name="medication"]'
          );
          const medicationDetails =
            document.getElementById("medication_details");

          medicationRadios.forEach((radio) => {
            radio.addEventListener("change", function () {
              if (this.value === "yes" && this.checked) {
                medicationDetails.classList.remove("d-none");
              } else {
                medicationDetails.classList.add("d-none");
              }
            });
          });
          workAbsenceRadios.forEach((radio) => {
            radio.addEventListener("change", function () {
              if (this.value === "yes" && this.checked) {
                workAbsenceDetails.classList.remove("d-none");
              } else {
                workAbsenceDetails.classList.add("d-none");
              }
            });
          });

          riskyActivitiesRadios.forEach((radio) => {
            radio.addEventListener("change", function () {
              if (this.value === "yes" && this.checked) {
                riskyActivitiesDetails.classList.remove("d-none");
              } else {
                riskyActivitiesDetails.classList.add("d-none");
              }
            });
          });

          beneficiaryTypeSelect.addEventListener("change", function () {
            if (this.value === "custom") {
              beneficiaryDetails.classList.remove("d-none");
            } else {
              beneficiaryDetails.classList.add("d-none");
            }
          });

          // Navigazione tra le sezioni
          next1Button.addEventListener("click", function () {
            if (validateSection("section-1")) {
              goToSection("section-1", "section-2");
            }
          });

          next2Button.addEventListener("click", function () {
            if (validateSection("section-2")) {
              goToSection("section-2", "section-3");
            }
          });

          prev2Button.addEventListener("click", function () {
            goToSection("section-2", "section-1");
          });

          prev3Button.addEventListener("click", function () {
            goToSection("section-3", "section-2");
          });

          // Gestione invio form
          form.addEventListener("submit", async function (event) {
            event.preventDefault();

            if (validateSection("section-3")) {
              submitBtn.disabled = true;
              submitBtn.innerHTML =
                '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Invio in corso...';

              // Simulazione invio dati (in produzione qui ci sarebbe la chiamata API)
              const formOfertaData = new FormData(form);

              let values = Object.fromEntries(formOfertaData.entries());

              values.health_questions = [
                document.getElementById("heart_disease"),
                document.getElementById("stroke"),
                document.getElementById("diabetes"),
                document.getElementById("cancer"),
                document.getElementById("respiratory"),
                document.getElementById("liver"),
                document.getElementById("kidney"),
                document.getElementById("epilepsy"),
                document.getElementById("multiple_sclerosis"),
                document.getElementById("mental_health"),
              ];
              values.health_questions_new = [];
              function addHealthQuestion(question, answer, comment = "") {
                values.health_questions_new.push({
                  question,
                  answer,
                  comment,
                });
              }

              if (document.getElementById("existing_insurance_yes").checked) {
                addHealthQuestion(
                  document.getElementById("existing_insurance_label")
                    .textContent,
                  true,
                  `Copertura totale esistente (CHF): ${
                    document.getElementById("existing_coverage").value ||
                    "non specificato"
                  }`
                );
              }

              if (document.getElementById("smoker_yes").checked) {
                addHealthQuestion(
                  document.getElementById("smoker_yes_lable").textContent,
                  true
                );
              }

              if (document.getElementById("medication_yes").checked) {
                addHealthQuestion(
                  document.getElementById("medication_yes_label").textContent,
                  true
                );

                addHealthQuestion(
                  document.getElementById("medication_resolved_label")
                    .textContent,
                  document.getElementById("medication_resolved_yes").checked
                    ? true
                    : false,
                  document.getElementById("medication_description").value || ""
                );
              }

              if (document.getElementById("hypertension_yes").checked) {
                addHealthQuestion(
                  document.getElementById("hypertension_yes_label").textContent,
                  true
                );
              }

              if (document.getElementById("hospitalization_yes").checked) {
                addHealthQuestion(
                  document.getElementById("hospitalization_yes_label")
                    .textContent,
                  true
                );
                addHealthQuestion(
                  document.getElementById("hospitalization_resolved_yes_label")
                    .textContent,
                  document.getElementById("hospitalization_resolved_yes")
                    .checked
                );
              }

              if (document.getElementById("planned_exam_yes").checked) {
                addHealthQuestion(
                  document.getElementById("planned_exam_yes").textContent,
                  true
                );
              }

              if (document.getElementById("drugs_yes").checked) {
                addHealthQuestion(
                  document.getElementById("drugs_yes_label").textContent,
                  true
                );
              }

              if (document.getElementById("hiv_yes").checked) {
                addHealthQuestion(
                  document.getElementById("hiv_yes_label").textContent,
                  true
                );
              }

              if (document.getElementById("foreign_stay_yes").checked) {
                addHealthQuestion(
                  document.getElementById("foreign_stay_yes_label").textContent,
                  true
                );
              }

              if (document.getElementById("dangerous_hobby_yes").checked) {
                addHealthQuestion(
                  document.getElementById("dangerous_hobby_yes_label")
                    .textContent,
                  true
                );
              }

              if (document.getElementById("pension_yes").checked) {
                addHealthQuestion(
                  document.getElementById("pension_yes_label").textContent,
                  true
                );
              }

              values.privacy_questions = [
                {
                  question: document.getElementById("privacy_consent_label")
                    .textContent,
                  answer: document.getElementById("privacy_consent").checked,
                  comment: "",
                },

                {
                  question: document.getElementById("terms_consent_label")
                    .textContent,
                  answer: document.getElementById("terms_consent").checked,
                  comment: "",
                },
                {
                  question: document.getElementById("mandate_consent_label")
                    .textContent,
                  answer: document.getElementById("mandate_consent").checked,
                  comment: "",
                },
                {
                  question: document.getElementById("marketing_consent_label")
                    .textContent,
                  answer: document.getElementById("marketing_consent").checked,
                  comment: "",
                },
              ];
              values["durata-custom"] =
                document.getElementById("durata-custom").value;
              const response = await richiediOfferta(values);
              console.log("response", response);
              console.log(values);

              sessionStorage.setItem("datiUtente", JSON.stringify(values));
              if (response.status === "ok") {
                submitBtn.disabled = false;
                form.style.display = "none";
                if (document.querySelector(".alert-info")) {
                  document.querySelector(".alert-info").style.display = "none";
                }
                // Nascondi gli indicatori di step
                document.querySelector(".step-indicator").style.display =
                  "none";

                document.querySelector(".progress").style.display = "none";
                // Mostra il messaggio di ringraziamento
                thankYouMessage.classList.add("active");
              } else {
                submitBtn.disabled = false;
                alert("Errore");
              }

              // Qui si potrebbe reindirizzare l'utente a una pagina di conferma
            }
          });
        });
      </script>
    </div>

    <script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/smoothscroll/smooth-scroll.js"></script>
    <script src="assets/ytplayer/index.js"></script>
    <script src="assets/dropdown/js/navbar-dropdown.js"></script>
    <script src="assets/theme/js/script.js"></script>
    <script src="assets/api-handlerSerhii.js"></script>

    <script>
      "use strict";
      if ("loading" in HTMLImageElement.prototype) {
        document.querySelectorAll('img[loading="lazy"]').forEach((e) => {
          e.src = e.dataset.src;
          if (e.getAttribute("style")) {
            e.setAttribute("data-temp-style", e.getAttribute("style"));
          }
          if (e.getAttribute("data-aspectratio")) {
            e.style.paddingTop = 100 * e.getAttribute("data-aspectratio") + "%";
            e.style.height = 0;
          }
          e.onload = function () {
            if (e.getAttribute("data-temp-style")) {
              e.setAttribute("style", e.getAttribute("data-temp-style"));
            } else {
              e.removeAttribute("style");
            }
            e.removeAttribute("data-temp-style");
          };
        });
      } else {
        const e = document.createElement("script");
        e.src =
          "https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js";
        document.body.appendChild(e);
      }
    </script>
  </body>
</html>
